
<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <meta charset='utf-8'>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script src="/javascripts/jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=181cc2f32eb9972755de22a185fa1d22"></script>
    <script>
        $(function(){
            $("#btnJoin").click(
                function(){
                    if($("#name").val() == "")
                    {
                        alert("매장 이름을 꼭 입력 하세요");
                        $("#name").focus();
                        return;
                    }
                    if($("#dtime").val() == "")
                    {
                        alert("배달 시간을 꼭 입력 하세요");
                        $("#dtime").focus();
                        return;
                    }
                    if($("#price").val() == "")
                    {
                        alert("최소 주문 금액을 꼭 입력 하세요");
                        $("#price").focus();
                        return;
                    }
                    if($("#tel2").val() == "")
                    {
                        alert("전화번호 두번째 자리를 확인해 주세요");
                        $("#tel2").focus();
                        return;
                    }
                    if($("#tel3").val() == "")
                    {
                        alert("전화번호 세번째 자리를 확인해 주세요");
                        $("#tel3").focus();
                        return;
                    }
                    if($("#lng").val() == "")
                    {
                        alert("가게 위치를 입력해주세요");
                        $("#lng").focus();
                        return;
                    }

                    var tel= $("#tel1").val() +'-'+ $("#tel2").val() +'-'+ $("#tel3").val();
                    $("#tel").val(tel);
                    $("#store_add").submit();
                });
            $("#btnRtn").click(
                function(){
                    location.href="/seller";
                })
        });
    </script>
  </head>
  <body>
    <h1><%= title %></h1>
    <form id="store_add" action="/store_add" method="post">
        <table width="400" border="1">
            <div id="map" style="width:400px;height:400px;"></div>
<p><em>지도를 클릭해주세요!</em></p> 

            <tr>
                <th>매장 이름</th>
                <td><input type="text" name="name" id="name" size="12" maxLength="12" required></td>
            </tr>
            <tr>
                <th>전화번호</th>
                <td>
                    <input type="hidden" name="tel" id="tel">
                    <select name="tel1" id="tel1">
                        <option value="010">010</option>
                        <option value="011">011</option>
                        <option value="016">016</option>
                        <option value="017">017</option>
                        <option value="018">018</option>
                        <option value="019">019</option>
                    </select>
                    -
                    <input type="text" name="tel2" id="tel2" size="4" maxLength="4" required>
                    -
                    <input type="text" name="tel3" id="tel3" size="4" maxLength="4" required>
                </td>
            </tr>
            <tr>
                <th>카테고리</th>
                <td>
                    <select name="category" id="category">
                        <% for(var i=0; i<rows.length; i++){ 
                            var item = rows[i];
                        %>
                        <option value="<%=item.ID%>"><%=item.NAME%></option>
                        <%}%>
                    </select>
                </td>
            </tr>
            <tr>
                <th>배달 시간</th>
                <td><input type="text" name="dtime" id="dtime" size="3" maxLength="3" required>분</td>
            </tr>
            <tr>
                <th>최소 주문 금액</th>
                <td><input type="text" name="price" id="price" size="6" maxLength="6" required>원</td>
            </tr>
            <tr>
                <th>오픈 시간</th>
                <td>
                    <input type="time" name="open" id="open" value="12:00:00" min="00:00:00" max="23:59:59">
                </td>
            </tr>
            <tr>
                <th>마감 시간</th>
                <td>
                    <input type="time" name="close" id="close" value="22:00:00" min="00:00:00" max="23:59:59">
                </td>
            </tr>
            <tr>
                <th>위도</th>
                <td>
                    <input type="text" id="lat" name="lat" value = "" required></td>
                </td>
            </tr>
            <tr>
                <th>경도</th>
                <td>
                    <input type="text" name="lng" id="lng" value="" required></td>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <input type="button" id="btnJoin" name="join" value="가게 추가">
                    <input type="button" id="btnRtn" name="return" value="돌아가기">
                </td>
            </tr>
        </table>
    </form>
    <script>
        var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
            mapOption = { 
                center: new kakao.maps.LatLng(37.619477, 127.058838), // 지도의 중심좌표
                level: 6 // 지도의 확대 레벨
            };
        
        var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
        
        // 지도를 클릭한 위치에 표출할 마커입니다
        var marker = new kakao.maps.Marker({ 
            // 지도 중심좌표에 마커를 생성합니다 
            position: map.getCenter() 
        }); 
        // 지도에 마커를 표시합니다
        marker.setMap(map);
        
        // 지도에 클릭 이벤트를 등록합니다
        // 지도를 클릭하면 마지막 파라미터로 넘어온 함수를 호출합니다
        kakao.maps.event.addListener(map, 'click', function(mouseEvent) {        
            
            // 클릭한 위도, 경도 정보를 가져옵니다 
            var latlng = mouseEvent.latLng; 
            
            // 마커 위치를 클릭한 위치로 옮깁니다
            marker.setPosition(latlng);
            
            var message = latlng.getLat();
            var message2 = latlng.getLng();
            
            var resultDiv = document.getElementById('lat'); 
            resultDiv.value = message;
            resultDiv.innerHTML = message;

            var resultDiv = document.getElementById('lng'); 
            resultDiv.value = message2;
            resultDiv.innerHTML = message2;
    
            
        });
    
        </script>
  </body>
</html>
